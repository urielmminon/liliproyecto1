{"paragraphs":[{"text":"%pyspark\nimport pyspark \nfrom pyspark.sql.session import SparkSession\nfrom pyspark.sql.functions import *  ","user":"anonymous","dateUpdated":"2019-03-31T21:53:12+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1554069180645_1903026259","id":"20190331-011223_1765200044","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:235","dateFinished":"2019-03-31T21:53:48+0000","dateStarted":"2019-03-31T21:53:12+0000"},{"text":"%pyspark\n# creamos la sesión de spark\nspark = SparkSession\\\n.builder\\\n.appName(\"spark_Parte3\")\\\n.getOrCreate()\n","user":"anonymous","dateUpdated":"2019-03-31T21:53:53+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1554069180650_-2099416837","id":"20190331-011233_1108320663","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:236","dateFinished":"2019-03-31T21:53:54+0000","dateStarted":"2019-03-31T21:53:53+0000"},{"text":"%pyspark\nprofecoDf = spark.read.format(\"csv\")\\\n        .option(\"delimiter\", \"|\")\\\n        .option(\"header\",\"true\")\\\n        .option(\"inferSchema\", \"true\")\\\n        .load(\"s3://urielmminonawsbucket/profeco_final_bash.csv\")","user":"anonymous","dateUpdated":"2019-03-31T21:54:18+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1554069180651_712781463","id":"20190331-011556_2019488827","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:237","dateFinished":"2019-03-31T22:04:28+0000","dateStarted":"2019-03-31T21:54:18+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=0","http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=1"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nprofecoDf.columns","user":"anonymous","dateUpdated":"2019-03-31T22:13:02+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['producto', 'presentacion', 'marca', 'categoria', 'catalogo', 'precio', 'fecharegistro', 'cadenacomercial', 'giro', 'nombrecomercial', 'direccion', 'estado', 'municipio', 'latitud', 'longitud']\n"}]},"apps":[],"jobName":"paragraph_1554069180651_1412490136","id":"20190331-011606_1913362288","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:238","dateFinished":"2019-03-31T22:13:02+0000","dateStarted":"2019-03-31T22:13:02+0000"},{"text":"%pyspark\nprofecoDf.count()","user":"anonymous","dateUpdated":"2019-03-31T22:13:11+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"62530715\n"}]},"apps":[],"jobName":"paragraph_1554069180652_-1861875977","id":"20190331-011720_2067024605","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:239","dateFinished":"2019-03-31T22:14:41+0000","dateStarted":"2019-03-31T22:13:11+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=2"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nprofecoDf.show(5)","user":"anonymous","dateUpdated":"2019-03-31T22:14:45+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------+----------------+----------------+------+-------------------+------------------+----------+--------------------+--------------------+----------------+--------------------+-------+---------+\n|            producto|        presentacion|   marca|       categoria|        catalogo|precio|      fecharegistro|   cadenacomercial|      giro|     nombrecomercial|           direccion|          estado|           municipio|latitud| longitud|\n+--------------------+--------------------+--------+----------------+----------------+------+-------------------+------------------+----------+--------------------+--------------------+----------------+--------------------+-------+---------+\n|cuaderno forma it...|96 hojas pasta du...|estrella|material escolar|utiles escolares|   259|2011-05-18 00:00:00|abastecedora lumen|papelerias|abastecedora lume...|cannes no 6 esq c...|distrito federal|tlalpan          ...|1929699|-99125417|\n|            crayones|caja 12 ceras jum...| crayola|material escolar|utiles escolares|   275|2011-05-18 00:00:00|abastecedora lumen|papelerias|abastecedora lume...|cannes no 6 esq c...|distrito federal|tlalpan          ...|1929699|-99125417|\n|            crayones|caja 12 ceras tam...| crayola|material escolar|utiles escolares|   139|2011-05-18 00:00:00|abastecedora lumen|papelerias|abastecedora lume...|cannes no 6 esq c...|distrito federal|tlalpan          ...|1929699|-99125417|\n|   colores de madera|caja 12 piezas la...|pincelin|material escolar|utiles escolares|   469|2011-05-18 00:00:00|abastecedora lumen|papelerias|abastecedora lume...|cannes no 6 esq c...|distrito federal|tlalpan          ...|1929699|-99125417|\n|         color largo|caja 36 piezas co...| crayola|material escolar|utiles escolares|   115|2011-05-18 00:00:00|abastecedora lumen|papelerias|abastecedora lume...|cannes no 6 esq c...|distrito federal|tlalpan          ...|1929699|-99125417|\n+--------------------+--------------------+--------+----------------+----------------+------+-------------------+------------------+----------+--------------------+--------------------+----------------+--------------------+-------+---------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1554069180652_-756247073","id":"20190331-011730_110143904","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:240","dateFinished":"2019-03-31T22:14:45+0000","dateStarted":"2019-03-31T22:14:45+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=3"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nprofecoDf.dtypes","user":"anonymous","dateUpdated":"2019-03-31T22:14:50+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('producto', 'string'), ('presentacion', 'string'), ('marca', 'string'), ('categoria', 'string'), ('catalogo', 'string'), ('precio', 'int'), ('fecharegistro', 'timestamp'), ('cadenacomercial', 'string'), ('giro', 'string'), ('nombrecomercial', 'string'), ('direccion', 'string'), ('estado', 'string'), ('municipio', 'string'), ('latitud', 'string'), ('longitud', 'string')]\n"}]},"apps":[],"jobName":"paragraph_1554069180652_1693589448","id":"20190331-011745_1705945885","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:241","dateFinished":"2019-03-31T22:14:50+0000","dateStarted":"2019-03-31T22:14:50+0000"},{"title":" 3.2 Guardar como .parquet","text":"%pyspark\nprofecoDf.write.parquet('s3://urielmminonawsbucket/profecoFinal.parquet')\n","user":"anonymous","dateUpdated":"2019-03-31T22:14:54+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1554069180653_-753623331","id":"20190331-012056_696585612","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:242","dateFinished":"2019-03-31T22:24:39+0000","dateStarted":"2019-03-31T22:14:54+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=4"],"interpreterSettingId":"spark"}}},{"title":"3.3 Cargar parquet en Spark","text":"%pyspark\nprofecoDfParquet = spark.read.format('parquet')\\\n        .load(\"s3://urielmminonawsbucket/profecoFinal.parquet\")","user":"anonymous","dateUpdated":"2019-03-31T22:37:08+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1554069180653_-635331900","id":"20190331-012113_441580636","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:243","dateFinished":"2019-03-31T22:37:08+0000","dateStarted":"2019-03-31T22:37:08+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=37"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nprofecoDfParquet.count()","user":"anonymous","dateUpdated":"2019-03-31T22:37:10+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554069545245_607940373","id":"20190331-215905_587525273","dateCreated":"2019-03-31T21:59:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5058","dateFinished":"2019-03-31T22:37:14+0000","dateStarted":"2019-03-31T22:37:10+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"62530715\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=38"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nprofecoDfParquet.show(1)","user":"anonymous","dateUpdated":"2019-03-31T22:37:17+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+-----+--------------------+-----------------+------+-------------------+---------------+--------------------+--------------------+--------------------+---------+---------+--------+----------+\n|            producto|        presentacion|marca|           categoria|         catalogo|precio|      fecharegistro|cadenacomercial|                giro|     nombrecomercial|           direccion|   estado|municipio| latitud|  longitud|\n+--------------------+--------------------+-----+--------------------+-----------------+------+-------------------+---------------+--------------------+--------------------+--------------------+---------+---------+--------+----------+\n|sistemas de teatr...|bh 4430 o bh 4430...|   lg|aparatos electron...|electrodomesticos|379900|2016-01-15 15:25:53|        elektra|tienda de electro...|elektra sucursal ...|boulevard lopez m...|zacatecas|zacatecas|22767258|-102574067|\n+--------------------+--------------------+-----+--------------------+-----------------+------+-------------------+---------------+--------------------+--------------------+--------------------+---------+---------+--------+----------+\nonly showing top 1 row\n\n"}]},"apps":[],"jobName":"paragraph_1554069180653_1035151890","id":"20190331-012312_1440159996","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:244","dateFinished":"2019-03-31T22:37:18+0000","dateStarted":"2019-03-31T22:37:17+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=39"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n#Poner disponible para ejecutar sentencias SQL en Spark\nprofecoDfParquet.createOrReplaceTempView(\"profecoDf\")","user":"anonymous","dateUpdated":"2019-03-31T22:37:21+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1554069180654_-2140658310","id":"20190331-012408_210917737","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:245","dateFinished":"2019-03-31T22:37:21+0000","dateStarted":"2019-03-31T22:37:21+0000"},{"text":"%pyspark\nprint(profecoDf.columns)","user":"anonymous","dateUpdated":"2019-03-31T22:37:23+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['producto', 'presentacion', 'marca', 'categoria', 'catalogo', 'precio', 'fecharegistro', 'cadenacomercial', 'giro', 'nombrecomercial', 'direccion', 'estado', 'municipio', 'latitud', 'longitud']\n"}]},"apps":[],"jobName":"paragraph_1554069180654_-944399842","id":"20190331-012425_340008107","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:246","dateFinished":"2019-03-31T22:37:23+0000","dateStarted":"2019-03-31T22:37:23+0000"},{"text":"%pyspark\n# Filtrar unicamente medicamentos\nspark.sql(\"SELECT * FROM profecoDf WHERE categoria='medicamentos'\").createOrReplaceTempView(\"profecoDfMed\")","user":"anonymous","dateUpdated":"2019-03-31T22:37:25+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1554069180654_1753558072","id":"20190331-012434_1570780659","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:247","dateFinished":"2019-03-31T22:37:25+0000","dateStarted":"2019-03-31T22:37:25+0000"},{"text":"%pyspark\n# Conteo de medicamentos\nspark.sql(\"SELECT count(1) FROM profecoDfMed\").show()","user":"anonymous","dateUpdated":"2019-03-31T22:37:31+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+\n|count(1)|\n+--------+\n|11485813|\n+--------+\n\n"}]},"apps":[],"jobName":"paragraph_1554069180655_2054679104","id":"20190331-012446_793824507","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:248","dateFinished":"2019-03-31T22:37:36+0000","dateStarted":"2019-03-31T22:37:31+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=40"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2019-03-31T22:35:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554071739204_55647108","id":"20190331-223539_2015050787","dateCreated":"2019-03-31T22:35:39+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11517"},{"text":"%pyspark\n# Existen productos sin marca identificados como 's/m' y 'sin marca' que representan una gran parte de los datos\nspark.sql(\"SELECT count(1) FROM profecoDfMed WHERE marca IN ('s/m','sin marca')\").show()","user":"anonymous","dateUpdated":"2019-03-31T22:37:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554069787262_-1203254005","id":"20190331-220307_44262949","dateCreated":"2019-03-31T22:03:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5134","dateFinished":"2019-03-31T22:37:49+0000","dateStarted":"2019-03-31T22:37:42+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+\n|count(1)|\n+--------+\n|10766552|\n+--------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=41"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nspark.sql(\"SELECT DISTINCT YEAR(fecharegistro) FROM profecoDfMed WHERE marca IN ('s/m','sin marca')\").show()","user":"anonymous","dateUpdated":"2019-03-31T22:37:53+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554071742213_-384464033","id":"20190331-223542_1878860591","dateCreated":"2019-03-31T22:35:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11589","dateFinished":"2019-03-31T22:38:01+0000","dateStarted":"2019-03-31T22:37:53+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------------------------+\n|year(CAST(fecharegistro AS DATE))|\n+---------------------------------+\n|                             2015|\n|                             2013|\n|                             2014|\n|                             2012|\n|                             2016|\n|                             2011|\n+---------------------------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=42","http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=43","http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=44","http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=45","http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=46"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n#Los productos sin marca corresponden a marcas genéricas\nt1=spark.sql(\"SELECT DISTINCT nombrecomercial FROM profecoDfMed WHERE marca IN ('s/m','sin marca')\")\nz.show(t1)","user":"anonymous","dateUpdated":"2019-03-31T22:27:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554069858711_-1017559503","id":"20190331-220418_1060186979","dateCreated":"2019-03-31T22:04:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5206","dateFinished":"2019-03-31T22:27:21+0000","dateStarted":"2019-03-31T22:27:09+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"nombrecomercial\nheb sucursal lincoln\nbodega aurrera sucursal estadio\nsuper san francisco de asis sucursal crucero\ns-mart sucursal anzalduas\nimss sucursal tequesquinahuac\nfarmacia vista hermosa\naurrera bodega sucursal  gobernadora\nfarmacias del ahorro sucursal chiapas\nfarmacias gi\nheb sucursal piedras negras\nfarmacia guadalajara sucursal 213\nfarmacia de similares sucursal monterrey 2\nmercado soriana sucursal libertad coahuila (561)\ndrogueria medina sucursal centro\nwalmart sucursal acapulco\nfarmacia sonora\nfarmacia guadalajara sucursal 326\nfarmacia lumig sucursal unica\nfarmacias similares sucursal cardenas\nwal mart sucursal combo pachuca\ncruz rosa\ncomercial mexicana sucursal centro\nfarmacia economik sucursal centro\nsoriana super sucursal nuevo laredo-maldonado\nfarmacia moderna sucursal escobedo\nsanborns sucursal centro\nfarmacia san pedro\nsuper aki sucursal 18\nchedraui sucursal alfredo del mazo\naurrera bodega sucursal hilario medina (3804)\naurrera bodega sucursal ferrocarril hidalgo\nbodega aurrera sucursal 5713\nfarmacias de similares sucursal 462\nfarmacias union sucursal reloj\nfarmaxi\nsoriana sucursal villahermosa guayabal\nchedraui sucursal del nino\nwal mart sucursal vado del rio\nfarmacia madero sucursal periferico\ncasa ley sucursal ley praderas\nsoriana sucursal 126\nfarmacia guadalajara sucursal 321\nmega comercial mexicana sucursal san jeronimo\nmega comercial mexicana sucursal boca del rio\noxxo sucursal chapultepec\nwal mart sucursal aeropuerto\ncasa ley sucursal 5 de mayo\nfarmacias m+ sucursal reforma\ndistribuidora queretana de medicamentos sucursal centro\nsumesa sucursal san angel\nfarmacia del carmen sucursal unica\nfarmacon sucursal paseo la paz\nfarmacias similares sucursal 7710\nmega comercial mexicana sucursal la diana\nmega comercial mexicana sucursal campeche\nalsuper sucursal 70 las rosas\nfarmacia guadalajara sucursal madero 52\nheb sucursal san nicolas\nley sucursal otay (1051)\nsumesa sucursal plaza san diego\nfarmacia capuchinas\nmega comercial mexicana sucursal portillo\nbodega aurrera express sucursal olimpica\nsoriana sucursal mitras\nfarmacias del ahorro sucursal magallanes\nfarmacias similares sucursal 96 pachuca 1\nmega comercial mexicana sucursal arboledas ii\nfarmacia roma sucursal reforma\nsoriana sucursal cuautitlan izcalli\nsoriana super sucursal cuernavaca\nsuper  soriana  sucursal eugenia\nfarmacia san juan\nwalmart sucursal villa coapa\nbodega aurrera sucursal 2027\nfarmacia del doctor descuento\nissstezac sucursal 1\nfarmacia sanchez sucursal madero\ns mart sucursal del nino\nchedraui sucursal cuernavaca flores magon\nfarmacias yza sucursal 401\nfarmacon sucursal periferico\nwal mart sucursal cloutier  3745\nsanborns sucursal misiones\nsoriana hiper sucursal reforma\nfarmacia guadalajara sucursal tecnologico colima\nsanborns sucursal azcapotzalco\nwalmart sucursal tepic\nwalmart sucursal boca del rio\naurrera bodega sucursal tlalneplantla\nbodega aurrera sucursal acapulco costera\nfarmacia medimax\nmercado soriana sucursal avenida\nissste farmacia sucursal 61\nheb sucursal monclova\nmercado soriana sucursal la florida\nmercado soriana\nfarmacias similares sucursal acapulco 3\nwal mart sucursal interlomas\nmega comercial mexicana sucursal mixcoac\nfarmacia farmahorro sucursal raza\nsoriana municipio torrecillas\nley sucursal plaza frontera (1210)\nsoriana sucursal iztapalapa\nfarmacia canto sucursal 3\nfarmacias yza sucursal playa imss\nsuperama sucursal unidad ruben dario\nbotica levi sucursal villas del rey\nfarmacia santa cecilia\nfarmacia guadalajara sucursal 225\nfarmacia cuernavaca\nsoriana hiper sucursal lauro villar\nfarmacia zapotlan\nheb sucursal 2930\nsuper chedraui sucursal  alta tension\nfarmacias especializadas\nfarmacia guadalajara\nfarmacia guadalajara sucursal 466\nbodega aurrera sucursal frontera\nsoriana super sucursal cruz del sur\nfarmacia cmq sucursal palmar de aramara\nwal mart  sucursal coacalco\nfarmacia abc del norte sucursal hospital\nfarmacia del mercado\nfarmacias similares sucursal villa de fuente\nfarmacias especializadas sucursal san luis potosi 1\nwal mart sucursal universidad\nbodega aurrera sucursal santa anita\nsoriana super sucursal 441\nbodega aurrera sucursal las fuentes\ncomercial mexicana sucursal insurgentes\nfarmacia guadalajara sucursal 245\nalsuper store sucursal independencia\noxxo sucursal colima\nwalmart sucursal echegaray\nsoriana hiper sucursal centro (34)\nfarmacias moderna sucursal morelos\nfarmacia saturno\nbodega aurrera sucursal san luis potosi\nwal mart sucursal metepec\nchedrahui sucursal durango (125)\nfarmacias similares sucursal 291\nissste\nfarmacias de similares sucursal vallarta\nfarmacia san jose\nissstey 60\ncasa ley sucursal plaza bahia\nwalmart sucursal 45-46\nvips sucursal continental\nfarma pronto\nwal mart sucursal azcapotzalco\nfarmacias similares sucursal culiacan 12\nsoriana sucursal norte\nfarmacias similares sucursal allende\nmercado soriana sucursal la viga recreo\nwal mart sucursal las torres\nfarmacias estrella sucursal mendez\nfarmacia del puerto sucursal magallanes\nfarmacia yza sucursal centro\nheb  sucursal san nicolas\nsoriana hiper sucursal coss\nsuper issste sucursal unica\nmercado soriana sucursal atizapan\nfarmacia sanchez sucursal 71\nwalmart sucursal playa del carmen\nel mirador sucursal fuentes\nfarmacias similares sucursal morelia\nsoriana sucursal oaxaca (105)\ncasa ley sucursal 1070\nchedraui sucursal mundo e\nfarmacia la estrella sucursal victoria\nfarmacia emergencias sucursal salvatierra\nwal mart sucursal lincoln\nsoriana hiper sucursal ciudad del carmen\nsanborns sucursal ciudad del carmen\nley sucursal independencia\nfarmacia guadalajara sucursal tlalnepantla centro\nwal mart sucursal plaza aragon\nfarmacia canto sucursal parque\naurrera bodega sucursal plaza atizapan\naurrera bodega sucursal xochimilco\nsoriana sucursal cordilleras\ndroguerias manzano\nfarmacia sanborns blvd sucursal huexotitla\nfarmacia similares sucursal division del norte\nfarmacia benavides sucursal pitic\nsumesa sucursal arboledas\nfarmacia luming\nbodega aurrera sucursal unidad camimo real 3119\nfarmacia benavides sucursal colon\nissste sucursal no 3 mexico\nsoriana sucursal coss\ndel bazar sucursal centro\nfarmacia de similares sucursal culiacan 12\nsanta cruz\nfarmacias similares sucursal 1173\nfarmacia de los angeles\nfarmacias similares sucursal tepic 8\nfarmacias guadalajara sucursal hidalgo\nsumesa sucursal polanco\nheb sucursal gonzalitos\nchedraui sucursal san luis potosi\nfarmacia el pueblo\nfarmacia similares sucursal puebla 1\nsoriana sucursal apizaco\nfarmacias benavides sucursal m582\ncity market sucursal huixquilucan\nchedraui sucursal los cabos\nfarmacia luming sucursal lira y ortega\nsuper issste sucursal 149\nley sucursal 1085\nde mas ahorro sucursal centro\nfarmapronto (matriz)\nfarmacias abc del norte sucursal unidad modelo\nsuperama sucursal michoacan\nsoriana hiper sucursal henequen\nsoriana hiper sucursal san marcos\nfarmacia nueva vida\nwalmart sucursal campeche\nwalmart sucursal reforma\nsoriana plus sucursal animas no 728\nfarmacia el fenix sucursal centro\nwal mart sucursal perinorte\nfarmacias del ahorro sucursal san jeronimo\nfarmacias guadalajara sucursal 909\nfarmacia canto sucursal crucero\nsoriana sucursal cuitlahuac\nwalmart sucursal tepeyac\nfarmacia san miguel matriz\nsoriana super sucursal blvd tuxtla\nley susursal plaza alica\nsoriana express sucursal campeche\nsuper issste\nbodega aurrera\nsoriana sucursal san marcos\nwalmart sucursal plaza galerias\nfarmacia san pablo tlalnepantla centro\nbodega aurrera sucursal salero 4042\nley sucursal juventud (1110)\nsanborn s sucursal 126 durango\nbodega aurrera sucursal fresnos\nbodega aurrera sucursal tapachula norte\nfarmacia lis\nwalmart sucursal tlalpan\nsuperama sucursal homero\nsoriana super sucursal del bosque\nsuperama sucursal pachuca\nluming sucursal cuauhtemoc-ap\nchedraui sucursal nuevo laredo\nwalmart sucursal blvd belisario\nchedraui sucursal cozumel\ncomercial mexicana sucursal acapulco 1\nsoriana super sucursal viaducto\nheb sucursal san luis potosi\nfarmacia benavides sucursal nuevo laredo\nsanborn s\nissste sucursal morelos\nsuper bodega montejo\nsoriana hiper sucursal san isidro (2)\nsoriana sucursal san nicolas\nsoriana hiper sucursal avenida 128\nwal mart sucursal copilco\nfarmacia benavides sucursal san marcos\nmega comercial mexicana sucursal av central\nwal mart  sucursal pirules\nfarmacias del sendero\nfarmacia canto sucursal alameda\nsuperama sucursal periferico\nfarmacias benavides sucursal xochimilco\nwal-mart\nbodega comercial mexicana sucursal iztapalapa las torres\ns mart sucursal constituyentes\nsoriana hiper sucursal 340\nwalmart sucursal plaza oriente\nfarmacia paris\nmega comercial mexicana\nfarmacias del ahorro sucursal diaz miron\nsuperama sucursal lindavista\nsuper aki extra\ncanto sucursal centro\nbotica kent tlaxcala sucursal tlaxcala\nmega comercial mexicana sucursal aguascalientes\nanda farmacias sin sucursal\nbodega aurrera express sucursal via lopez portillo\nfarmacia la paz sucursal cuernavaca\nbodega aurrera sucursal 4199\nsoriana super sucursal morelos sur 613\nfarmacia benavides sucursal arboledas\nmega comercial mexicana sucursal la villa\nfarmacia guadalajara sucursal 216\nwalmart sucursal 2432\naurrera bodega sucursal 1o de mayo\ndrogueria y farmacia san jose del calvario\nfarmacia fatima\nsuperama    sucursal la noria\nissste sucursal burocratas\nfarmacia guadalajara sucursal miguel aleman 072\nfarmacon sucursal abasolo\nchedraui sucursal oaxaca reforma\nfarmacia de similares sucursal 96 pachuca 1\nissste sucursal no 110\nfarmacias fama sucursal 14\nmega comercial mexicana sucursal tangamanga\nsoriana express sucursal coacalco\nfarmacia santa maria\nsoriana hiper sucursal centro maya\nfarmacia benavides sucursal paseo de la asuncion\nfarmacia san pablo sucursal mixcoac\nfarmacias klyns sucursal torreon\nbodega aurrera sucursal villahermosa guayabal\nbodega aurrera sucursal centro\nbodega aurrera sucursal 2224\nfamacia benavides sucursal herradura\nfarmacia canto sucursal gobernadores\nsoriana super sucursal aztecas\nfarmacia guadalajara sucursal 31 poniente (1222)\nfarmacias similares sucursal 7950\nmercado soriana sucursal cuautitlan\nfarmacia cme\nfarmacia bazar sucursal 1\nsanborn s sucursal gran plaza\nchedraui sucursal aguascalientes\nfarmacia guadalajara sucursal 388\nsumesa sucursal oaxaca\nfarmacia guanajuato\nsoriana sucursal mixcoac\nfarmacon sucursal lomas del faro\nfarmacias y similares sucursal industrial\nfarmacias benavides sucursal hotel oriente\nfarmacia las torres\nissste sucursal no 39 centro\nfarmatodo sucursal xochimilco\nfarmacia gin\nfarmacia balandra\nfarmacia benavides sucursal juarez\nchedraui sucursal centro sur\nsuperama sucursal acoxpa\nbodega aurrera sucursal 11 sur\nsuper che sucursal 601\nfarmacia guadalajara sucursal 431\nfarmacia denis\nfarmacia guadalajara sucursal 635\nsuperama sucursal sena\nbodega comercial mexicana sucursal sta maria la ribera\nmega comercial mexicana sucursal tlaquepaque\nfarmacia de dios\nfarmacia del ahorro sucursal 1202\nfarmacias similares sucursal puebla 1\nwal mart sucursal revolucion\nsuperfarmacias de ensenada\nchedraui sucursal cardenas\nmega comercial mexicana sucursal la paz\nfarmacias similares sucursal fc-655\nfarmacia caballero sucursal unica\nfarmacia economik sucursal politecnico\naurrera bodega sucursal santa lucia\nsanborn's sucursal plaza las americas\nmega comercial mexicana sucursal los balcones\nsanborns sucursal revolucion\ns-mart sucursal morelos\nfarmacia simi sucursal fc2378\nfarmacias benavides sucursal x018\nfarmacia del ahorro sucursal tulum\nsuper issste sucursal bodega 092\nfarmacias similares sucursal cozumel 5-128\nfarmacias del ahorro sucursal zocalo\nbodega aurrera sucursal 1417\nfarmacia issseg sucursal plaza del mariachi (18)\nsoriana sucursal perinorte\nfarmacia especializada\nfarmacia del ahorro sucursal chauhtemoc\nfarmacia liquis sucursal 01\noxxo\nsoriana hiper sucursal nogales\ncomercial mexicana sucursal gran plaza\nfarmacia mexicana sucursal guadalupe\nbenavides sucursal 10049\nwalmart sucursal aeropuerto campeche (sede)\nfarmacia benavides sucursal lomas\nfarmacia del ahorro sucursal lomas\nsoriana sucursal rio nilo\nchedraui sucursal mina\nfarmacias union sucursal playa\nsoriana sucursal no 74\nfarmapronto sucursal javier mina\nchedraui sucursal periferico unica\nmega comercial mexicana sucursal satelite\nfarmacias similares sucursal campeche 7\nsuper gutierrez sucursal piedras negras i\nchedraui sucursal unica\nwalmart sucursal matamoros\nbodega aurrera sucursal fuentes del valle\nsuperama sucursal parques polanco\nwalmart sucursal domingo diez\nfarmapronto matriz\nsanta fe sucursal a04\nwal mart sucursal tepeyac\nwal mart sucursal multiplaza arboledas\nwalmart sucursal ensenada\nbodega aurerra sucursal kabah\nfarmacon sucursal guasave\nfarmacia durango\nfarmacias similares sucursal morelos\nfarmacia santo domingo, sucursal matriz\nsoriana sucursal lincoln\nfarmacia kino sucursal matriz\nsoriana plus sucursal miramontes\nimss sucursal campesino\nfarmacia del pueblo\nsoriana sucursal 35\nfarmacias del ahorro sucursal 31 poniente\nfarmacias gi matriz\nbodega aurrera express sucursal 1699\nwal mart sucursal pitillal\nmega comercial mexicana villahermosa deportiva\nfarmacia de descuento union sucursal 16 de septiembre\nbodega comercial mexicana sucursal ecatepec\nsoriana super sucursal justo sierra\nsuper issste sucursal mxl 729\nissste sucursal 29\nas farmacias sin sucursal\nsuperama sucursal gobernadores\nsanborns\nsuper issste sucursal san luis potosi\nfarmacias del pueblo sucursal roman cepeda\nwalmart sucursal cd juarez\nsanta fe sucursal murcia\nfarmacia sanchez\nalsuper sucursal alameda\nsuper issste sucursal 001\nsuperama sucursal las torres\nfarmacias del ahorro sucursal vista hermosa\nmi tienda del ahorro sucursal cabezada\nsoriana sucursal plaza canek\nbodega comercial mexicana sucursal izcalli\nfarmacia central sucursal nuevo laredo\nfarmacias similares\nfarmacias similares sucursal leon 1\nbenavides sucursal galerias\nsoriana hiper sucursal del rio\nmega comercial mexicana sucursal izcalli\nfarmacias similares sucursal 1373\ncomercial mexicana sucursal asturias\ngems de descuento\naurrera bodega sucursal plaza churubusco\naurrera bodega sucursal mariano escobedo\nmega comercial mexicana sucursal anahuac\nfarmacia hospital reforma\nsoriana super sucursal cozumel\nfarmacias benavides sucursal catedral\nfarmacia cristy\nfarmacias yza sucursal centro\nwal mart sucursal miguel aleman\nfarmacias benavides sucursal 1 de mayo\nfarmacias similares sucursal 62\nsuperama sucursal viveros\nsoriana sucursal 86\nsoriana hiper sucursal lopez mateos\nsanborns sucursal plaza mayor\nwalmart sucursal plaza aragon\nbodega aurrera express sucursal los gallos\nsoriana hiper sucursal chetumal\nfarmacia benavides sucursal republica\nfarmacia san jorge\nfarmacia guadalajara sucursal 756\nsupermercado gonzalez\nfarmacias zapotlan sucursal corregidora\nfarmacia san andres\nley express sucursal auroras\nwalmart sucursal fuentes mares\nfarmacia del hospital aranda de la parra\nbodega aurrera sucursal centro constituyentes\ncomercial mexicana sucursal carrousel\nfarmacia premier\nfarmacia emergencias sucursal buelna\nfarmacia benavides sucursal hiedra\nwal mart sucursal buenavista\nfarmacia el fenix del centro\nfarmacia mas farmacias sucursal 31\nchedraui sucursal neza norte\nfarmacia el fenix sucursal 133\nissste sucursal 226\nfarmacia emergencias sucursal obregon\nsuperama sucursal lomas\nsanborns sucursal el dorado san luis potosi\nbodega aurrera sucursal cabo san lucas\nfarmacias la salud sucursal narciso mendoza\nfarmacia guadalajara sucursal 74 lerdo\nheb sucursal torreon\nsanborns sucursal cuernavaca\nliverpool\nfarmacia guadalajara sucursal juarez\ncomercial mexicana\nchedraui sucursal plaza del carmen centro\nfarmacias yza sucursal madero\nmercado soriana sucursal la asuncion\nfarmacia medex sucursal 303\nissste farmacia sucursal degollado\nchedraui sucursal tepic\nfarmacias especializadas sucursal cuernavaca\nsanborns sucursal forum culiacan\nsanborns sucursal vallarta\nfarmacia especializada sucursal volcanes\nchedraui sucursal tuxtla oriente\nsoriana hiper sucursal piedras negras\nsuper farmacia el rosario\nwal mart sucursal tlalpan\nsuperama sucursal la marina\nfarmacias benavides sucursal sevilla del rio\nsoriana sucursal tacubaya\nsoriana hiper sucursal las rosas\nwalmart sucursal galerias saltillo\nmercado soriana sucursal centro\nfarmacia benavides sucursal san jose\nfarmacia del ahorro sucursal zocalo\nfarmacia de similares\nfarmacia lumig\nfarmacia salvatierra\nchedraui sucursal cayaco\nfarmacias similares sucursal f1443\nfarmacia sufacen sucursal limiones\nfarmacias yza sucursal 605\nsanborn s sucursal 1144 villah americas\nsuper chedraui sucursal aztecas\nwalmart sucursal los cabos\nbodega aurrera sucursal doctores\nwalmart sucursal el molinito\nfarmatodo sucursal mina\nsoriana sucursal plaza del valle\nsmart sucursal la fe\nsuper issste sucursal 231\ntortilleria el farito i\nsoriana hiper sucursal fuentes mares\nwal mart sucursal cuitlahuac\nwalmart sucursal saltillo\nfarmacias del ahorro sucursal  alameda\nmercado soriana sucursal coacalco\nsanborns sucursal pachuca\nchedraui sucursal rio nilo\nbodega comercial mexicana sucursal tacuba\nfarmacia san isidro\nfarmacia central sucursal carranza\nfarmacia guadalajara sucursal 1092\nwalmart sucursal el pasito\nfarmacias del ahorrro sucursal lira\nwalmart sucursal perinorte\nchedraui sucursal torres landa\nsoriana sucursal la viga\nfarmacia la mas barata sucursal el caballito\ncomercial mexicana sucursal ensenada\nsuperama sucursal division del norte\nchedraui sucursal cancun i tulum\nbodega comercial mexicana sucursal los pinos slp\nsoriana hiper sucursal los cabos\nfarmacia guadalajara sucursal del valle\nbodega comercial mexicana sucursal casa blanca\ncomercial mexicana sucursal la herradura\nmercado soriana sucursal tlaxcala\ncomercial mexicana sucursal aragon\nchedraui sucursal chetumal insurgentes americas\nfarmacia santa maria sucursal monclova\nfarmacias guadalajara sucursal diaz miron\nfarmacias similares sucursal 03\nfarmacon sucursal salvatierra\nfarmacia zapotlan sucursal matriz\nfarmacia san francisco de asis sucursal  174\ncalimax sucursal herradura\nbodega aurrera sucursal chetumal\nliverpool sucursal morelia\nfarmacia guadalajara sucursal 03\nsuperama sucursal portal churubusco\nmega comercial mexicana sucursal  mega estadio\nfarmacia san francisco de asis sucursal 174\nsuper mercado aramburo sucursal forjadores\nfarmacia cruz blanca\naurrera bodega sucursal la viga\naurrera bodega sucursal atemajac\nguadalajara sucursal bandera\nmega comercial mexicana sucursal cozumel\nfarmacias yza sucursal 233\nsoriana hiper sucursal calafia\nfarmacia santa fe\nchedraui sucursal montejo\nfarmacias similares sucursal industrial\nwalmart sucursal tijuana hipodromo\nchedraui sucursal  centro sur\nfarmacias guelaguetza matriz\nbodega aurrera sucursal piedras negras\nsanborns sucursal 1041\nheb sucursal 2984\nmega comercial mexicana sucursal torres landa\nbodega comercial mexicana sucursal azcapotzalco\nmega comercial mexicana sucursal la viga\nchedraui sucursal tuxtla crystal\nvyr sucursal plaza aragon\nfarmacia del parque de apizaco\nfarmacia san martin\ns mart\ncomercial mexicana sucursal plaza coacalco\nfarmacias similares de monterrey\nbodega aurrera sucursal itzaes\nfarmacia la providencia matriz\nsoriana sucursal ex-base aerea\nfarmacia plaza\nfarmacias similares sucursal lopez mateos\ns mart  sucursal jilotepec\nsanborns sucursal plaza q\nfarmatodo sucursal cuernavaca\nfarmacia del ahorro sucursal rutilo torres\nissste farmacia sucursal 60\nfarmacias del rosario sucursal san isidro\nfarmacon sucursal leyva solano\nfarmacia del centro\naurrera bodega sucursal av central\nsanborns sucursal 1194\nfarmacia del ahorro sucursal casa de justicia\nfarmapronto\nmega comercial mexicana sucursal coacalco\nissste sucursal 229\nwalmart sucursal aeropuerto\nsoriana hiper sucursal cigarrera 100\naurrera bodega sucursal villa coapa\nfarmacia similares sucursal unica\nfarmacias benavides sucursal inegi\nwalmart sucursal copilco\nfarmacias guadalajara sucursal independencia\nwalmart sucursal cola de ballena\nwalmart sucursal multiplaza arboledas\nfarmacias similares sucursal vallarta\nchedraui sucursal acapulco pie de la cuesta\naurrera bodega sucursal plaza aragon\nissste farmacia sucursal 102\nfarmacia del dr descuento sucursal aguascalientes\nheb sucursal morelos\nfarmacom sucursal nayarit\nsanborns sucursal los arquitos\nwalmart susursal 1054 colima norte\nfarmacia de similares sucursal leon 1\nfarmacon sucursal lazaro cardenas\nwalmart\nsoriana sucursal cantil\nsuper ley express sucursal revolucion (1263)\nfarmacia zapotlan sucursal rey coliman\naurrera bodega sucursal cantil\nmega comercial mexicana sucursal el olivar\nfarmacias yza sucursal matriz\nfarmacia la union sucursal 58\nmega comercial mexicana sucursal flamingos\nissste sucursal nuevo repueblo\nfarmacias similares sucursal reforma\nfarmacia el fenix\nfarmacia guadalajara sucursal clouthier\nmega comercial mexicana sucursal ciudad del carmen\nbotica guadalupana\nsuperama sucursal montejo\nwal mart sucursal lomas\nsuper aki xtra sucursal cozumel\nfarmacia bazar\nchedraui sucursal coapa\nfarmacia similares sucursal 657 tlaxcala 2\nmercado soriana sucursal cardenas\nfarmacias similares sucursal 7462\nmi bodega aurrera sucursal 4169\nbodega aurrera sucursal agua prieta\nsuperama sucursal la noria\nchedraui plaza cristal\nbodega aurrera sucursal tacubaya\nfarmacias de descuento union sucursal campeche universidad\ncomercial mexicana sucursal el dorado\nwal mart\nfarmacias benavides sucursal m564\nsmart sucursal el capitan\nmercado express soriana sucursal 536\nfarmacias guadalajara sucursal 157\nsoriana plus sucursal quintana\nsuperama sucursal unica\nsumesa sucursal yucatan\ns mart sucursal cesar lopez de lara\nsoriana sucursal plaza las americas\nfarmacia flores y regalos\nsoriana sucursal culiacan\nsoriana hiper sucursal hidalgo\nfarmacia el fenix sucursal 231\nfarmacias guadalajara la calma\nsuperama sucursal av toluca\ncalimax sucursal rio\nfarmacias guadalajara sucursal tlalnepantla\nfarmacia del puerto\nfarmacia del ahorro sucursal hacienda loreto\nmi bodega aurrera unidad huamantla\nfarmacias del ahorro sucursal 776\nmercado soriana sucursal calzada\nfarmacia benavides sucursal mexico\nwalmart sucursal coacalco\nfarmacias yza sucursal 239\nfarmacias guadalajara sucursal ernesto talavera\nwal mart sin sucursal\nbodega aurrera sucursal topo chico\nwalmart sucursal san luis potosi\nchedraui sucursal anfora\nheb sucursal las fuentes\nfarmacias yza sucursal 234\nfarmacia del ahorro sucursal del valle\nmega comercial mexicana sucursal cascadas\naurrera bodega sucursal bolivar\nmega comercial mexicana sucursal coapa\nwalmart sucursal cuitlahuac\nfarmatodo sucursal plaza aragon\nahorro farmacia\nmega comercial mexicana sucursal la campina\nfarmacia del ahorro franquicia 1\nfarmacia hidalgo\nfarmacias de similares sucursal centro\nfarmacias benavides sucursal parque lerdo\nchedraui\nsuperama sucursal campestre\nmercado soriana sucursal tapachula 219\nissste sucursal justo sierra\nwal mart sucursal plaza oriente\nsoriana hiper sucursal poliforum\nsanborns sucursal tijuana rio\nchedraui sucursal campeche\ncomercial mexicana sucursal ermita\nwal mart supercenter  nueva antequera\nbodega comercial mexicana sucursal center p\nfarmatodo\nfarmacia del ahorro sucursal norte\nbodega aurrera sucursal 4169\nbodega aurrera sucursal 3018\nfarmacia similar sucursal 14\naurrera bodega sucursal 3767\nmercado soriana sucursal r-1 la gobernadora\nmega comercial mexicana sucursal mega mercado\nsuperama sucursal luis cabrera\nsuperama sucursal milenio\nwal mart sucursal villa coapa\nchedraui sucursal sexta\nfarmacia pey pharma sucursal 2\naurrera bodega sucursal los angeles\nfarmacia lopez sucursal centro\nfarmacia panama\nfarmacia benavides sucursal heron ramirez\nbodega aurrera sucursal 3103\nmercado soriana sucursal reforma\nfarmacias  abc del norte sucursal unidad modelo\nfarmacia benavides sucursal 5 de mayo\nfarmacias similares sucursal torreon\nwal mart sucursal 1727\nfarmacias similares sucursal 401\nfarmacia universitaria alexander fleming (volcanes)\nsoriana sucursal 327\nfarmacia flemingo\nsoriana super sucursal 248\ncasa ley sucursal tres rios\nbodega aurrera  sucursal emilio carranza\nwalmart sucursal torres del sur\nley plaza san fernando\nfarmacia del ahorro sucursal retiro\nsoriana sucursal coapa\nmercado soriana sucursal la sierra\nfarmacia fama sucursal 60\naurrera bodega sucursal iztapalapa\nfarmacia benavides sucursal real del arco\nwalmart sucursal insurgentes chetumal\nwalmart sucursal la rosita 3622\nfarmacia de similares sucursal pino suarez\nissste farmacia sucursal 230\nfarmacia santa rosa\nbodega aurrera sucursal santo domingo\nfarmacia de la luz\nfarmacia benavides sucursal catorce\nfarmacia san pablo sucursal aragon\nfarmacia del ahorro\nfarmacia la guadalupana\nel mirador matriz\nwalmart sucursal san jose del cabo\nsuper mercado aramburo sucursal 16 de septiembre\nmega comercial chapultepec sucursal 144\nfarmacia del ahorro sucursal republica\nfarmacias yza sucursal mina\ncalimax sucursal 20 de noviembre\nfarmacia pattys sucursal san marcos\nwal mart sucursal balbuena\nfarmacias purex sucursal 6\nfarmacia guadalajara sucursal zaragoza guasave\ncalimax sucursal zaragoza\nbodega comercial mexicana sucursal plaza jardines tultitlan\nfarmacias de similares sucursal colima 03\nissste sucursal 44\nbodega comercial mexicana sucursal tlalnepantla\nfarma norte sucursal seguro social\nfarmacias canto sucursal matriz\nwal mart sucursal tapachula\nfarmacia moderna\nfarmacia popular roman sucursal unica\nwalmart sucursal vallarta\nsanborns sucursal satelite\nissste sucursal 052\nfarmacia nueva imperial sucursal matriz\nfarmacia santa fe sucursal pina\nfarmacia guadalajara sucursal presidente carranza\nsoriana super sucursal 309\nfarmacia benavides sucursal10313\nfarmacia guadalajara sucursal nueva california\nfarmacia lopez sucursal silvia\ncomercial mexicana  sucursal mega mercado\nsoriana sucursal echegaray\nfarmacias del ahorro sucursal 11 sur\nfarmacias del ahorro sucursal olivar de los padres\nfarmacias benavides sucursal san carlos\nfarmacia union de descuento\nwal mart sucursal echegaray\nissste sucursal no 61\ncomercial mexicana sucursal vallarta\nmercado soriana sucursal acapulco centro (398)\nliverpool sucursal puebla\nfarmacia guadalajara sucursal 591\nissste sucursal no 246\nfarmacias issste\nsuperama sucursal lomas anahuac\nsoriana super sucursal central\naurrera bodega sucursal cuautitlan 1\nfarmatodo sucursal 31 pte\naurrera bodega sucursal valle de aragon\nbodega aurrera sucursal 3869\nmega comercial mexicana sucursal angelopolis 290\nsoriana sucursal la villa\nfarmacias similares sucursal camino al faro\nsoriana hiper sucursal 197\nfarmacia union sucursal montecristo\nissste sucursal 7\nheb sucursal chipinque\nbodega aurrera sucursal diaz miron\nissste sucursal 117\nbodega aurrera sucursal lazaro cardenas (3078)\nunam sucursal 02 cd universitaria\nfarmacia estrella\nbodega comercial mexicana sucursal lopez portillo\ncomercio sucursal centro\nfarmacia guadalajara sucursal centro\nfarmacia yza sucursal uxmal\nfarmacias yza sucursal colosio\nmercado soriana sucursal 226\nissste sucursal no 252\nfarmacia y drogueria toluca\nchedraui sucursal atizapan\nchedraui sucursal centro\nsoriana hiper sucursal acapulco costera (274)\nbodega aurrera sucursal aeropuerto\nsoriana super sucursal del lago\nmega comercial mexicana sucursal playa del carmen\nsoriana sucursal consulado\nsuper suarez\nchedraui sucursal la paz colima\nmaxifarma sucursal inegi\nsoriana hyper\ndel sol\nfarmacia azteca sucursal mercado\nfarmacia madir sucursal unica\nfarmacia de similares sucursal 5-194\nfarmacias similares sucursal centro\nsoriana sucursal floresta\nsanborns sucursal hiper plaza mirador\nsoriana super sucursal tepic (310)\nfarmacia ideal sucursal pino suarez\nfarmacia guadalajara sucursal heron ramirez\nsoriana sucursal malecon 30\nmega comercial mexicana  sucursal toluca/ tollocan\nwalmart sucursal lomas\nchedraui sucursal acueducto\nsoriana sucursal parque delta\nchedraui sucursal del carmen\nfarmacia san jose sucursal matriz\nfarmacias similares sucursal 816\ns mart sucursal fuentes mares\nsanborns sucursal villa coapa\nfarmacia san judas tadeo\naurrera bodega sucursal  arboledas\nsuperama sucursal rio churubusco\nfarmacias gi sucursal torreon\nfarmacia el fenix sucursal  madero\nley express sucursal cangrejos\nfarmacias de super ahorro\nfarmacia lumig sucursal lira y ortega\nheb sucursal nuevo laredo\nfarmacias del ahorro sucursal garibaldi\nsoriana super sucursal campeche\nfarmacia del ahorro sucursal poniente\nsoriana sucursal aragon\ncasa ley sucursal la paz\nsoriana plus sucursal 44\nmega comercial\nmega comercial mexicana sucursal casino de la selva\nchedraui sucursal plaza america\nfarmacia la miniatura\nfarmacia lumig sucursal cuauhtemoc\nsoriana\nsoriana hiper sucursal mision\nfarmacia bazar sucursal playa\nmega comercial mexicana sucursal plaza san pedro\nfarmacia juquilita\nfarmacia guadalajara sucursal 162\ncomercial mexicana sucursal villas de la hacienda\nfarmacia union sucursal hidalgo\nfarmacia similares sucursal 7188\nbotica central sucursal ortiz mena\nfarmacia similares sucursal 1124\nwal mart sucursal torres lindavista\nfarmacia similares\nsoriana hiper sucursal nuevo laredo-la fe\nsoriana super sucursal constitucion\nfarmacia del ahorro sucursal pasaje\nsoriana sucursal naucalpan\nfarmacia abc sucursal providencia\nfarmacia de similares matriz\nmz sucursal guasave\nsoriana plus sucursal polanco\nsanborns sucursal galerias\ntorre medica\nfarmacia abc sucursal vallarta\nwalmart sucursal 3506\nfarmacia de similares sucursal  madero-apizaco\nfarmacias especializadas sucursal nogales\nwalmart sucursal nogales el greco\ncomercial mexicana  sucursal coapa\nbotica guadalupana sucursal cachanilla\nbodega aurrera sucursal cozumel\nfarmacia san jose sucursal de la fuente\nfarmacia benavides sucursal guasave\nh e b sucursal saltillo republica\ns mart sucursal lopez mateos\nfarmacia la guadalupana sucursal centro sur\nchedraui sucursal tapachula sur\nwalmart sucursal mexicali\nheb sucursal 2962\nhipermercado soriana sucursal rio\nfarmacia el fenix sucursal tijuana 21\nfarmacia guadalajara sucursal centro huamantla\nwal mart sucursal encinas\nbodega aurrera sucursal patricio trueba\nsoriana hiper sucursal sol tuxtla gutierrez\nsuper issste sucursal cc 168\nsuper gutierrez sucursal plaza piedras negras\nfarmacias del ahorro sucursal juarez\nbodega comercial mexicana sucursal naucalpan\nfarmacia benavides sucursal olachea\nheb sucursal guadalupe\nsuperama sucursal echegaray\nissste sucursal 287\nsoriana super sucursal plaza real\nfarmacia del angel sucursal centro\nfarmacias similares sucursal 99\nsoriana super sucursal plaza fiesta\n"},{"type":"TEXT","data":"\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=10","http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=11","http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=12","http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=13","http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=14"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n# Se eliminan las marcas s/m y sin marca ya que son la mayoría y afecta los resultados del análisis\nspark.sql(\"SELECT * FROM profecoDfMed WHERE marca NOT IN ('s/m','sin marca')\").createOrReplaceTempView(\"profecoDfMed\")","user":"anonymous","dateUpdated":"2019-03-31T22:27:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554069895156_-1787154092","id":"20190331-220455_1378752798","dateCreated":"2019-03-31T22:04:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5278","dateFinished":"2019-03-31T22:27:43+0000","dateStarted":"2019-03-31T22:27:43+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nspark.sql(\"SELECT count(1) FROM profecoDfMed\").show()","user":"anonymous","dateUpdated":"2019-03-31T22:27:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554069902983_1023786130","id":"20190331-220502_1890173212","dateCreated":"2019-03-31T22:05:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5350","dateFinished":"2019-03-31T22:27:54+0000","dateStarted":"2019-03-31T22:27:47+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+\n|count(1)|\n+--------+\n|  719261|\n+--------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=15"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n# Eliminar Vista para liberar RAM\nspark.catalog.dropTempView(\"profecoDf\")","user":"anonymous","dateUpdated":"2019-03-31T22:27:58+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1554069180656_416479131","id":"20190331-012526_464544851","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:250","dateFinished":"2019-03-31T22:27:58+0000","dateStarted":"2019-03-31T22:27:58+0000"},{"title":"3.3 Pregunta 1 ¿Cuańtas marcas diferentes tiene tu categoría?","text":"%pyspark\np1 =spark.sql(\"SELECT COUNT(*) AS total FROM (SELECT DISTINCT(marca) FROM profecoDfMed)\")\nz.show(p1)","user":"anonymous","dateUpdated":"2019-03-31T22:28:09+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"total":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"total\n75\n"},{"type":"TEXT","data":"\n"}]},"apps":[],"jobName":"paragraph_1554069180656_46235842","id":"20190331-012605_1401234852","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:251","dateFinished":"2019-03-31T22:28:08+0000","dateStarted":"2019-03-31T22:28:01+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=16"],"interpreterSettingId":"spark"}}},{"title":"3.3 Pregunta 2 ¿Cuál es la marca con mayor precio? ¿En qué estado?","text":"%pyspark\np2 = spark.sql(\"SELECT marca, precio, estado FROM profecoDfMed ORDER BY precio DESC LIMIT 1\")\nz.show(p2)","user":"anonymous","dateUpdated":"2019-03-31T22:28:21+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"marca":"string","precio":"string","estado":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"marca\tprecio\testado\nglaxo wellcome mexico, sa de cv\t211275\taguascalientes\n"},{"type":"TEXT","data":"\n"}]},"apps":[],"jobName":"paragraph_1554069180657_747405139","id":"20190331-012643_1117389464","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:253","dateFinished":"2019-03-31T22:28:20+0000","dateStarted":"2019-03-31T22:28:13+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=17"],"interpreterSettingId":"spark"}}},{"title":" 3.3 Pregunta 3 ¿Cuál es la marca con menor precio en CDMX? (en aquel entonces Distrito Federal)","text":"%pyspark\np3=spark.sql(\"SELECT marca, precio, estado FROM profecoDfMed WHERE estado='distrito federal' ORDER BY precio ASC LIMIT 1\")\nz.show(p3)","user":"anonymous","dateUpdated":"2019-03-31T22:28:31+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"marca":"string","precio":"string","estado":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"marca\tprecio\testado\nmedimart gi valdecasas\t5\tdistrito federal\n"},{"type":"TEXT","data":"\n"}]},"apps":[],"jobName":"paragraph_1554069180658_412647712","id":"20190331-012728_1283250509","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:255","dateFinished":"2019-03-31T22:28:30+0000","dateStarted":"2019-03-31T22:28:23+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=18"],"interpreterSettingId":"spark"}}},{"title":"3.3 Pregunta 4 ¿Cuál es la marca con mayores observaciones?","text":"%pyspark\np4 =spark.sql(\"SELECT marca, COUNT(marca) AS observaciones FROM profecoDfMed GROUP BY marca ORDER BY COUNT(marca) DESC LIMIT 1\")\nz.show(p4)","user":"anonymous","dateUpdated":"2019-03-31T22:28:42+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"marca\tobservaciones\naventis pharma, sa de cv\t54648\n"},{"type":"TEXT","data":"\n"}]},"apps":[],"jobName":"paragraph_1554069180658_-282934587","id":"20190331-012837_678731266","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:257","dateFinished":"2019-03-31T22:28:48+0000","dateStarted":"2019-03-31T22:28:42+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=19"],"interpreterSettingId":"spark"}}},{"title":"3.3 Pregunta 5 ¿Ha dejado de existir alguna marca durante los años que tienes? ¿Cuál? ¿Cuándo desapareció?","text":"%pyspark\n# Obtener el año máximo\nmaxYears =spark.sql(\"SELECT MAX(year(fecharegistro)) AS year FROM profecoDfMed\").rdd.flatMap(lambda x: x).collect()\nmaxYears=str(maxYears[0])\nmaxYears","user":"anonymous","dateUpdated":"2019-03-31T22:29:06+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"'2013'\n"}]},"apps":[],"jobName":"paragraph_1554069180659_-2052387808","id":"20190331-012934_530123655","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:259","dateFinished":"2019-03-31T22:29:14+0000","dateStarted":"2019-03-31T22:29:06+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=20"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nspark.sql(\"SELECT DISTINCT marca, MAX(year(fecharegistro)) AS maxYear  \\\n          FROM profecoDfMed \\\n          GROUP BY marca\").createOrReplaceTempView(\"profecoDistMarcYear\")","user":"anonymous","dateUpdated":"2019-03-31T22:29:20+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1554069180661_-1014024662","id":"20190331-013036_972875896","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:262","dateFinished":"2019-03-31T22:29:20+0000","dateStarted":"2019-03-31T22:29:20+0000"},{"text":"%pyspark\n# Marca y año que desapareció\n# Se considera que el año en que desapareció es el año siguiente al último registrado\np5=spark.sql(\"SELECT marca, maxYear+1 AS desYear FROM profecoDistMarcYear WHERE maxYear<{0}\".format(maxYears))","user":"anonymous","dateUpdated":"2019-03-31T22:29:28+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1554069180661_1877968374","id":"20190331-013045_1611161928","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:263","dateFinished":"2019-03-31T22:29:28+0000","dateStarted":"2019-03-31T22:29:28+0000"},{"text":"%pyspark\nz.show(p5)","user":"anonymous","dateUpdated":"2019-03-31T22:29:31+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"marca":"string","desYear":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"marca\tdesYear\nprimer nivel pisa\t2013\nsmithkline beecham farmaceutica, sa de cv\t2013\nalpharma\t2012\ngi antibioticos de mexico\t2013\ngi antibioticos de puebla\t2012\nlaboratorios sanfer, sa de cv\t2013\neli lilly y compania de mexico, sa de\t2013\nabbott laboratories de mexico, sa de c\t2013\nastrazeneca, sa de cv\t2013\nmerck-mexico, sa\t2013\nschering plough, sa de cv\t2013\nmedimart valdecasas\t2013\nmedimart gi quimica y farmacia\t2012\nlaboratorios senosiain, sa de cv\t2013\nfarmacom gi kendrick\t2013\nnovartis farmaceutica, sa de cv\t2013\nfarmacom quimica y farmacia\t2013\norganon mexicana, sa de cv\t2013\njanssen farmaceutica, sa de cv\t2013\nquimica son's\t2013\nprimer nivel bioresearch\t2013\nbyk gulden, sa de cv\t2013\nprimer nivel novaginfancia\t2013\nwyeth, sa de cv\t2013\nmedimart gi valdecasas\t2013\nprimer nivel carbel\t2013\nbiomep\t2013\ngi grimann\t2013\ngi best\t2013\ngi biomep\t2012\nprimer nivel gi protein\t2013\ndalux\t2013\nfarmacom gi quimica y farmacia\t2013\nmaver\t2013\nbayer de mexico, sa de cv\t2013\nfarmacom gi randall\t2013\nlaboratorios searle de mexico, sa de cv\t2013\nfarmacom loeffler\t2013\narmstrong laboratorios de mexico, sa de cv\t2013\neli lilly y compania de mexico, sa de cv\t2013\nmedimart kendrick\t2013\nluna\t2013\nboehringer ingelheim promeco, sa de cv\t2013\nprimer nivel gi novaginfancia\t2013\nfarmacom - g i apotex\t2012\nprimer nivel gi ivax pharmaceuticals\t2013\nmedimart gi tecnofarma\t2013\npharmacia & upjohn, sa de cv\t2013\nbruluagsa\t2013\ng i protein\t2012\nmedimart gi hormona\t2013\nmedimart gi kener\t2013\nschering mexicana, sa de cv\t2013\nfarmacom - gi quimica y farmacia\t2012\nproductos roche, sa de cv\t2013\nprimer nivel gi arlex\t2013\nprimer nivel gi waldel\t2013\nbest\t2013\nprimer nivel arlex\t2013\nabbott laboratories de mexico, sa de cv\t2013\nfarmacom gi ranbaxi laboratories limited\t2013\ndegort's chemical\t2013\nsyntex, sa de cv\t2013\ng i hormona\t2012\nfarmacom gi valdecasas\t2013\naventis pharma, sa de cv\t2013\nfarmacom gi apotex\t2012\nglaxo wellcome mexico, sa de cv\t2013\nmead johnson de mexico, sa de cv\t2012\nmerck-mexico, sa de cv\t2013\nbristol-myers squibb de mexico, sa de cv\t2013\nmedimart quimica y farmacia\t2013\nlaboratorios grossman, sa de cv\t2013\n"},{"type":"TEXT","data":"\n"}]},"apps":[],"jobName":"paragraph_1554069180661_1503416237","id":"20190331-013102_888578773","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:264","dateFinished":"2019-03-31T22:29:39+0000","dateStarted":"2019-03-31T22:29:31+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=21","http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=22","http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=23","http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=24","http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=25"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\np5.count()","user":"anonymous","dateUpdated":"2019-03-31T22:33:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554071601643_-1339404804","id":"20190331-223321_929319594","dateCreated":"2019-03-31T22:33:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11229","dateFinished":"2019-03-31T22:34:04+0000","dateStarted":"2019-03-31T22:33:32+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"73\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=31"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n# Crear Vista profecoDistMarcYear\nprofecoDfParquet.createOrReplaceTempView(\"profecoDistMarcYear\")","user":"anonymous","dateUpdated":"2019-03-31T22:30:11+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1554069180662_910351530","id":"20190331-013110_218743177","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:265","dateFinished":"2019-03-31T22:30:11+0000","dateStarted":"2019-03-31T22:30:11+0000"},{"title":"3.3 Pregunta 6 Genera una gráfica de serie de tiempo por estado para la marca con mayor precio -en todos los años-, donde el eje equis es el año y el eje ye es el precio máximo.","text":"%pyspark\ndatos_grafica = spark.sql(\"SELECT MAX(precio), estado FROM profecoDfMed GROUP BY estado\")","user":"anonymous","dateUpdated":"2019-03-31T22:30:15+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1554069180662_1710924438","id":"20190331-013358_2053271667","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:266","dateFinished":"2019-03-31T22:30:15+0000","dateStarted":"2019-03-31T22:30:15+0000"},{"text":"%pyspark\nspark.sql(\"SELECT DISTINCT A.marca,A.estado,A.precio \\\n        FROM profecoDfMed A\\\n        INNER JOIN \\\n            (SELECT MAX(precio) AS precio, estado FROM profecoDfMed GROUP BY estado) B \\\n        ON A.estado = B.estado \\\n        AND A.precio = B.precio\").createOrReplaceTempView(\"profecoDfMaxPrecio\")","user":"anonymous","dateUpdated":"2019-03-31T22:30:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554069180663_-656981845","id":"20190331-013450_1656613500","dateCreated":"2019-03-31T21:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:268","dateFinished":"2019-03-31T22:30:27+0000","dateStarted":"2019-03-31T22:30:26+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\ndf = spark.sql(\"SELECT marca,estado,MAX(precio) as maxPrecio,YEAR(fecharegistro) as year \\\n        FROM profecoDfMed WHERE marca||estado IN (SELECT marca||estado FROM profecoDfMaxPrecio) \\\n        GROUP BY marca,estado,YEAR(fecharegistro)\")","user":"anonymous","dateUpdated":"2019-03-31T22:30:30+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554070294187_865876855","id":"20190331-221134_254688258","dateCreated":"2019-03-31T22:11:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5549","dateFinished":"2019-03-31T22:30:30+0000","dateStarted":"2019-03-31T22:30:30+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nz.show(df)","user":"anonymous","dateUpdated":"2019-03-31T22:31:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"marca":"string","estado":"string","maxPrecio":"string","year":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","lineWithFocus":false}},"commonSetting":{},"keys":[{"name":"year","index":3,"aggr":"sum"}],"groups":[{"name":"estado","index":1,"aggr":"sum"}],"values":[{"name":"maxPrecio","index":2,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554070338483_-688589987","id":"20190331-221218_1521969053","dateCreated":"2019-03-31T22:12:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5621","dateFinished":"2019-03-31T22:31:02+0000","dateStarted":"2019-03-31T22:30:35+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"marca\testado\tmaxPrecio\tyear\nglaxo wellcome mexico, sa de cv\tjalisco\t160542\t2012\nglaxo wellcome mexico, sa de cv\toaxaca\t127854\t2012\nglaxo wellcome mexico, sa de cv\tqueretaro\t147874\t2012\nglaxo wellcome mexico, sa de cv\ttabasco\t154205\t2012\nglaxo wellcome mexico, sa de cv\ttlaxcala\t168095\t2012\nglaxo wellcome mexico, sa de cv\taguascalientes\t211275\t2011\nglaxo wellcome mexico, sa de cv\thidalgo\t147868\t2012\nglaxo wellcome mexico, sa de cv\tsonora\t153418\t2012\nglaxo wellcome mexico, sa de cv\tguanajuato\t160542\t2012\nglaxo wellcome mexico, sa de cv\tdurango\t160542\t2012\nglaxo wellcome mexico, sa de cv\tcolima\t168992\t2012\nglaxo wellcome mexico, sa de cv\tyucatan\t152095\t2012\nglaxo wellcome mexico, sa de cv\tmichoacan de ocampo\t171104\t2012\npharmacia & upjohn, sa de cv\tnuevo leon\t104341\t2011\nglaxo wellcome mexico, sa de cv\tpuebla\t171104\t2012\nglaxo wellcome mexico, sa de cv\tdistrito federal\t175395\t2011\nglaxo wellcome mexico, sa de cv\ttabasco\t154205\t2011\nglaxo wellcome mexico, sa de cv\tmexico\t168992\t2011\nglaxo wellcome mexico, sa de cv\tzacatecas\t209076\t2012\nglaxo wellcome mexico, sa de cv\tsinaloa\t147868\t2012\nglaxo wellcome mexico, sa de cv\tdistrito federal\t153413\t2012\nglaxo wellcome mexico, sa de cv\tmexico\t160542\t2012\nglaxo wellcome mexico, sa de cv\tdurango\t160542\t2011\nglaxo wellcome mexico, sa de cv\tyucatan\t174995\t2011\nglaxo wellcome mexico, sa de cv\tjalisco\t211248\t2011\nglaxo wellcome mexico, sa de cv\tveracruz de ignacio de la llave\t147868\t2011\npharmacia & upjohn, sa de cv\tnuevo leon\t109595\t2012\nglaxo wellcome mexico, sa de cv\tcoahuila de zaragoza\t174998\t2011\nglaxo wellcome mexico, sa de cv\tquintana roo\t168992\t2011\nglaxo wellcome mexico, sa de cv\tcolima\t168992\t2011\nglaxo wellcome mexico, sa de cv\tsonora\t153413\t2011\nglaxo wellcome mexico, sa de cv\tcoahuila de zaragoza\t160542\t2012\nglaxo wellcome mexico, sa de cv\toaxaca\t153413\t2011\nglaxo wellcome mexico, sa de cv\ttlaxcala\t174599\t2011\nglaxo wellcome mexico, sa de cv\thidalgo\t153414\t2011\nglaxo wellcome mexico, sa de cv\tmichoacan de ocampo\t171104\t2011\nglaxo wellcome mexico, sa de cv\tsinaloa\t153413\t2011\nglaxo wellcome mexico, sa de cv\tzacatecas\t209076\t2011\nglaxo wellcome mexico, sa de cv\tpuebla\t175647\t2011\nglaxo wellcome mexico, sa de cv\tquintana roo\t47835\t2012\nglaxo wellcome mexico, sa de cv\tqueretaro\t179554\t2011\nglaxo wellcome mexico, sa de cv\tguanajuato\t168992\t2011\n"},{"type":"TEXT","data":"\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=26","http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=27","http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=28","http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=29","http://ip-172-31-10-236.us-west-2.compute.internal:4040/jobs/job?id=30"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n# Eliminar Vista para liberar RAM\nspark.catalog.dropTempView(\"profecoDfMaxPrecio\")\nspark.catalog.dropTempView(\"profecoDfMed\")","user":"anonymous","dateUpdated":"2019-03-31T22:12:53+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554070356428_1723960820","id":"20190331-221236_1969084745","dateCreated":"2019-03-31T22:12:36+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5693"}],"name":"Punto3","id":"2E6UJCEWM","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}